# Role-Based Views - Visual Guide

## ðŸ‘¨â€ðŸ« Faculty/Admin View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Classroom â†’ Announcements Tab                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CREATE NEW ANNOUNCEMENT                                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  Title: [___________________________]                   â”‚   â”‚
â”‚  â”‚  Content: [___________________________]                 â”‚   â”‚
â”‚  â”‚           [___________________________]                 â”‚   â”‚
â”‚  â”‚  Tags: [___________________________]                    â”‚   â”‚
â”‚  â”‚  Link: [___________________________]                    â”‚   â”‚
â”‚  â”‚  â˜‘ Important  â˜‘ Urgent  â˜‘ Pinned                       â”‚   â”‚
â”‚  â”‚  [Post Announcement]                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  [Search...] [ðŸ“Œ Important] [âš¡ Urgent] [ðŸ“ Pinned] [Clear]   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ðŸ“Œ Assignment 1: Requirements Specification            â”‚   â”‚
â”‚  â”‚  ðŸ‘¤ Saurabh Tiwari â€¢ Professor â”‚ ðŸ“… Oct 15, 2025       â”‚   â”‚
â”‚  â”‚  [Important] [Assignment]                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  Please submit the SRS document for the project...     â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚  ðŸ”— View Assignment Details                            â”‚   â”‚
â”‚  â”‚  Last edited: Oct 16, 2025                             â”‚   â”‚
â”‚  â”‚  [ðŸ“Œ Pin] [âœï¸ Edit] [â†©ï¸ Undo] [ðŸ—‘ï¸ Delete]             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Welcome to Software Engineering!                       â”‚   â”‚
â”‚  â”‚  ðŸ‘¤ Saurabh Tiwari â€¢ Professor â”‚ ðŸ“… Sep 10, 2025       â”‚   â”‚
â”‚  â”‚  [General]                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  Welcome everyone! Please go through the course...     â”‚   â”‚
â”‚  â”‚  [ðŸ“Œ Pin] [âœï¸ Edit] [ðŸ—‘ï¸ Delete]                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Faculty/Admin Can:**
- âœ… Create new announcements
- âœ… Edit any announcement
- âœ… Delete announcements
- âœ… Pin/unpin to highlight
- âœ… Undo last edit
- âœ… Search and filter
- âœ… View all announcements

---

## ðŸ‘¨â€ðŸŽ“ Student View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Classroom â†’ Announcements Tab                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [Search...] [ðŸ“Œ Important] [âš¡ Urgent] [ðŸ“ Pinned] [Clear]   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ðŸ“Œ Assignment 1: Requirements Specification            â”‚   â”‚
â”‚  â”‚  ðŸ‘¤ Saurabh Tiwari â€¢ Professor â”‚ ðŸ“… Oct 15, 2025       â”‚   â”‚
â”‚  â”‚  [Important] [Assignment]                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  Please submit the SRS document for the project...     â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚  ðŸ”— View Assignment Details                            â”‚   â”‚
â”‚  â”‚  Last edited: Oct 16, 2025                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Welcome to Software Engineering!                       â”‚   â”‚
â”‚  â”‚  ðŸ‘¤ Saurabh Tiwari â€¢ Professor â”‚ ðŸ“… Sep 10, 2025       â”‚   â”‚
â”‚  â”‚  [General]                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  Welcome everyone! Please go through the course...     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Students Can:**
- âœ… View all announcements (read-only)
- âœ… Search announcements
- âœ… Filter by important/urgent/pinned
- âœ… Click external links
- âŒ **CANNOT** create announcements
- âŒ **CANNOT** edit announcements
- âŒ **CANNOT** delete announcements
- âŒ **CANNOT** pin/unpin

---

## ðŸ” How Role Detection Works

### Code Flow:
```javascript
// 1. Firebase Auth detects logged-in user
useEffect(() => {
  onAuthStateChanged(auth, async (currentUser) => {
    if (currentUser) {
      // 2. Check email domain
      const isInstructorEmail = 
        currentUser.email?.endsWith("@instructor.com") || 
        currentUser.email?.endsWith("@admin.com");

      // 3. Fetch user role from MongoDB
      const res = await fetch(`/api/users?uid=${currentUser.uid}`);
      const data = await res.json();
      
      // 4. Set isAdmin flag
      setIsAdmin(data.user?.role === "instructor" || isInstructorEmail);
    }
  });
}, []);
```

### Conditional Rendering:
```jsx
// Create form shown ONLY to admins
{isAdmin && user && (
  <CreateAnnouncement ... />
)}

// Action buttons shown ONLY to admins
<AnnouncementCard 
  isAdmin={isAdmin}  // Prop passed to card
  ...
/>
```

### In AnnouncementCard.jsx:
```jsx
{isAdmin && (
  <div className="flex items-center gap-2">
    <Button onClick={handleTogglePin}>Pin</Button>
    <Button onClick={handleEdit}>Edit</Button>
    <Button onClick={handleUndo}>Undo</Button>
    <Button onClick={handleDelete}>Delete</Button>
  </div>
)}
```

---

## ðŸ“Š Database Integration Flow

### Same Database, Different Collections:
```
MongoDB Atlas Database: "virtual_classroom"
â”‚
â”œâ”€â”€ users                    (Existing)
â”œâ”€â”€ classrooms               (Existing)
â”œâ”€â”€ assignments              (Existing)
â”œâ”€â”€ submissions              (Existing)
â”œâ”€â”€ courses                  (Existing)
â”œâ”€â”€ notifications            (Existing)
â”œâ”€â”€ announcements            (NEW - Your feature)
â””â”€â”€ announcement_activity    (NEW - Audit logs)
```

### Data Flow:
```
1. User creates announcement â†’ POST /api/announcements
2. API validates user role
3. API saves to MongoDB "announcements" collection
4. API logs activity to "announcement_activity" collection
5. Frontend refreshes list
6. All users see announcement (role determines if they can edit/delete)
```

### MongoDB Connection:
```javascript
// lib/mongodb.js - Single connection for ALL features
const clientPromise = new MongoClient(process.env.MONGODB_URI);

// Existing collections
export async function getUsersCollection() { ... }
export async function getAssignmentsCollection() { ... }

// New announcement collections (same database!)
export async function getAnnouncementsCollection() { 
  const db = await getDatabase();
  return db.collection('announcements');
}
```

---

## âœ… Feature Parity Verification

### Original Standalone System:
- âœ… Express.js backend
- âœ… Mongoose models
- âœ… HTML/CSS/JS frontend
- âœ… Separate faculty & student pages

### Integrated System:
- âœ… Next.js API routes (Express equivalent)
- âœ… MongoDB native driver (Mongoose equivalent)
- âœ… React/Radix UI frontend (HTML/CSS/JS equivalent)
- âœ… Same page, conditional rendering (faculty & student separation)

### All Features Migrated:
1. âœ… Create announcement
2. âœ… View announcements by classroom
3. âœ… Search announcements
4. âœ… Filter by important
5. âœ… Filter by urgent
6. âœ… Filter by pinned
7. âœ… Filter by tags
8. âœ… Filter by date range
9. âœ… Get single announcement
10. âœ… Update/edit announcement
11. âœ… Delete announcement
12. âœ… Toggle pin
13. âœ… Undo last edit
14. âœ… Get tags by classroom
15. âœ… Get activity/audit trail
16. âœ… Edit history tracking
17. âœ… Activity logging
18. âœ… Title field
19. âœ… Content field
20. âœ… Author name & role
21. âœ… Classroom ID
22. âœ… Subject
23. âœ… Important flag
24. âœ… Urgent flag
25. âœ… Pinned flag
26. âœ… Tags array
27. âœ… External link
28. âœ… Timestamps

### Enhancements Added:
29. âœ… Edit dialog (not in original)
30. âœ… Delete confirmation (not in original)
31. âœ… Better UI with Radix components
32. âœ… Dark mode support
33. âœ… Full accessibility (a11y)

---

## ðŸŽ¯ Testing Checklist

### Database Integration:
- [ ] Announcements saved to same MongoDB database
- [ ] Can query announcements alongside users/assignments
- [ ] Activity logs properly stored
- [ ] Edit history preserved

### Role-Based Access:
- [ ] Login as faculty â†’ See create form + action buttons
- [ ] Login as student â†’ No create form, no action buttons
- [ ] Faculty can create announcements
- [ ] Faculty can edit announcements
- [ ] Faculty can delete announcements
- [ ] Students can only view

### Feature Parity:
- [ ] All 28 original features work
- [ ] Search functionality works
- [ ] Filters work (important, urgent, pinned, tags)
- [ ] Pin/unpin works
- [ ] Edit with history works
- [ ] Undo works
- [ ] Delete works
- [ ] Activity logging works

---

**Summary:** The integration maintains complete separation between student and admin views while using a unified database and having 100% feature parity with the original standalone system, plus enhancements! âœ…
